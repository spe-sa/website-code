!function($){var e,o,r=0,c={control:$('<div class="colorPicker-picker">&nbsp;</div>'),palette:$('<div id="colorPicker_palette" class="colorPicker-palette" />'),swatch:$('<div class="colorPicker-swatch">&nbsp;</div>'),hexLabel:$('<label for="colorPicker_hex">Hex</label>'),hexField:$('<input type="text" id="colorPicker_hex" />')},t="transparent",n;$.fn.colorPicker=function(e){return this.each(function(){var o=$(this),n=$.extend({},$.fn.colorPicker.defaults,e),i=$.fn.colorPicker.toHex(o.val().length>0?o.val():n.pickerDefault),l=c.control.clone(),a=c.palette.clone().attr("id","colorPicker_palette-"+r),s=c.hexLabel.clone(),d=c.hexField.clone(),f=a[0].id,h,u;if($.each(n.colors,function(e){h=c.swatch.clone(),n.colors[e]===t?(h.addClass(t).text("X"),$.fn.colorPicker.bindPalette(d,h,t)):(h.css("background-color","#"+this),$.fn.colorPicker.bindPalette(d,h)),h.appendTo(a)}),s.attr("for","colorPicker_hex-"+r),d.attr({id:"colorPicker_hex-"+r,value:i}),d.bind("keydown",function(e){if(13===e.keyCode){var r=$.fn.colorPicker.toHex($(this).val());$.fn.colorPicker.changeColor(r?r:o.val())}27===e.keyCode&&$.fn.colorPicker.hidePalette()}),d.bind("keyup",function(e){var r=$.fn.colorPicker.toHex($(e.target).val());$.fn.colorPicker.previewColor(r?r:o.val())}),$('<div class="colorPicker_hexWrap" />').append(s).appendTo(a),a.find(".colorPicker_hexWrap").append(d),n.showHexField===!1&&(d.hide(),s.hide()),$("body").append(a),a.hide(),l.css("background-color",i),l.bind("click",function(){o.is(":not(:disabled)")&&$.fn.colorPicker.togglePalette($("#"+f),$(this))}),e&&e.onColorChange?l.data("onColorChange",e.onColorChange):l.data("onColorChange",function(){}),(u=o.data("text"))&&l.html(u),o.after(l),o.bind("change",function(){o.next(".colorPicker-picker").css("background-color",$.fn.colorPicker.toHex($(this).val()))}),o.val(i),"input"===o[0].tagName.toLowerCase())try{o.attr("type","hidden")}catch(k){o.css("visibility","hidden").css("position","absolute")}else o.hide();r++})},$.extend(!0,$.fn.colorPicker,{toHex:function(e){if(e.match(/[0-9A-F]{6}|[0-9A-F]{3}$/i))return"#"===e.charAt(0)?e:"#"+e;if(!e.match(/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/))return!1;var o=[parseInt(RegExp.$1,10),parseInt(RegExp.$2,10),parseInt(RegExp.$3,10)],r=function(e){if(e.length<2)for(var o=0,r=2-e.length;r>o;o++)e="0"+e;return e};if(3===o.length){var c=r(o[0].toString(16)),t=r(o[1].toString(16)),n=r(o[2].toString(16));return"#"+c+t+n}},checkMouse:function(r,c){var t=o,n=$(r.target).parents("#"+t.attr("id")).length;r.target===$(t)[0]||r.target===e[0]||n>0||$.fn.colorPicker.hidePalette()},hidePalette:function(){$(document).unbind("mousedown",$.fn.colorPicker.checkMouse),$(".colorPicker-palette").hide()},showPalette:function(o){var r=e.prev("input").val();o.css({top:e.offset().top+e.outerHeight(),left:e.offset().left}),$("#color_value").val(r),o.show(),$(document).bind("mousedown",$.fn.colorPicker.checkMouse)},togglePalette:function(r,c){c&&(e=c),o=r,o.is(":visible")?$.fn.colorPicker.hidePalette():$.fn.colorPicker.showPalette(r)},changeColor:function(o){e.css("background-color",o),e.prev("input").val(o).change(),$.fn.colorPicker.hidePalette(),e.data("onColorChange").call(e,$(e).prev("input").attr("id"),o)},previewColor:function(o){e.css("background-color",o)},bindPalette:function(o,r,c){c=c?c:$.fn.colorPicker.toHex(r.css("background-color")),r.bind({click:function(e){n=c,$.fn.colorPicker.changeColor(c)},mouseover:function(e){n=o.val(),$(this).css("border-color","#598FEF"),o.val(c),$.fn.colorPicker.previewColor(c)},mouseout:function(r){$(this).css("border-color","#000"),o.val(e.css("background-color")),o.val(n),$.fn.colorPicker.previewColor(n)}})}}),$.fn.colorPicker.defaults={pickerDefault:"2a2a2a",colors:["181c41","193b44","57575a","808080","b4b4b9","0f1c97","26416c","365d98","3B5998","007BB5","808bcf","FFCC00","eeeeee","ffffff"],addColors:[],showHexField:!0}}(jQuery);